/* empty css              */import{a as axios}from"./axios-3a3ab110.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{r as ref,o as openBlock,c as createElementBlock,a as createVNode,w as withCtx,b as createBaseVNode,B as Button,H as Modal,A as List,d as createTextVNode,F as Fragment,z as renderList,J as Input,U as Upload,S as Space,x as createBlock,u as unref,K as IconDelete,I as Image,N as Avatar,D as ListItemMeta,P as Popconfirm,G as ListItem}from"./index-be962d38.js";const _hoisted_1={class:"ml-4 mt-4 mr-4"},_hoisted_2=createBaseVNode("h1",{class:"text-xl"},"视频管理",-1),_hoisted_3=createBaseVNode("p",null,"视频上传：",-1),_hoisted_4=createBaseVNode("p",null,"封面图上传 (最好为16:9的图，否则比例有点奇怪)",-1),_hoisted_5=["src"],_sfc_main={__name:"VideoManager",setup(__props){const videoList=ref([]),baseURL=window.location.href.split(":")[0]+":"+window.location.href.split(":")[1]+":8020",baseImageFolder="/resource/upload/images/",addVideoDialog=ref(!1),videoName=ref(""),title=ref(""),description=ref(""),headImage=ref(""),uploadVideo=ref([]),uploadImage=ref([]);getVideoList();function getVideoList(){axios.get(baseURL+"/api/videoList").then(res=>{videoList.value=eval(res.data)})}function deleteVideo(t){axios.get(baseURL+"/api/deleteVideo?id="+t.Id+"&videoName="+t.VideoName+"&headImage="+t.HeadImage).then(a=>{getVideoList()})}function uploadVideoSuccess(t){videoName.value=t.name}function uploadImageSuccess(t){headImage.value=t.name}function cancelAddVideo(){videoName.value!==""&&axios.get(baseURL+"/api/deleteVideoFile?videoName="+videoName.value),headImage.value!==""&&axios.get(baseURL+"/api/deleteImageFile?imageName="+headImage.value),videoName.value="",headImage.value="",title.value="",description.value="",uploadVideo.value=[],uploadImage.value=[]}async function addVideo(){return videoName.value===""?(alert("视频还没有上传完吧，或者还没有上传视频。"),!1):headImage.value===""?(alert("未上传封面图。"),!1):title.value===""||description.value===""?(alert("视频标题和简介不能为空。"),!1):(await axios.get(baseURL+"/api/addVideo?videoName="+videoName.value+"&title="+title.value+"&description="+description.value+"&headImage="+headImage.value),getVideoList(),videoName.value="",headImage.value="",title.value="",description.value="",uploadVideo.value=[],uploadImage.value=[],!0)}function onVideoRemove(){axios.get(baseURL+"/api/deleteVideoFile?videoName="+videoName.value)}function onImageRemove(){axios.get(baseURL+"/api/deleteImageFile?imageName="+headImage.value)}return(t,a)=>{const l=Button,o=Input,i=Upload,d=Space,s=Modal,n=Image,r=Avatar,c=ListItemMeta,u=Popconfirm,m=ListItem,p=List;return openBlock(),createElementBlock("div",_hoisted_1,[_hoisted_2,createVNode(l,{type:"primary",onClick:a[0]||(a[0]=e=>addVideoDialog.value=!addVideoDialog.value)},{default:withCtx(()=>[createTextVNode("发布视频")]),_:1}),createVNode(s,{visible:addVideoDialog.value,"onUpdate:visible":a[5]||(a[5]=e=>addVideoDialog.value=e),onCancel:cancelAddVideo,"on-before-ok":addVideo,width:"auto"},{title:withCtx(()=>[createTextVNode(" 发布视频 ")]),default:withCtx(()=>[createBaseVNode("div",null,[createVNode(d,{direction:"vertical",class:"w-full"},{default:withCtx(()=>[createVNode(o,{placeholder:"视频标题",modelValue:title.value,"onUpdate:modelValue":a[1]||(a[1]=e=>title.value=e)},null,8,["modelValue"]),createVNode(o,{placeholder:"视频简介 30字内",modelValue:description.value,"onUpdate:modelValue":a[2]||(a[2]=e=>description.value=e),"max-length":"30"},null,8,["modelValue"]),_hoisted_3,createVNode(i,{draggable:"",action:baseURL+"/api/uploadVideo",accept:"video/*",limit:1,onSuccess:uploadVideoSuccess,"file-list":uploadVideo.value,"onUpdate:fileList":a[3]||(a[3]=e=>uploadVideo.value=e),onOnBeforeRemove:onVideoRemove},null,8,["action","file-list"]),_hoisted_4,createVNode(i,{"list-type":"picture-card",action:baseURL+"/api/uploadImage","image-preview":"",limit:1,accept:"image/*",onSuccess:uploadImageSuccess,"file-list":uploadImage.value,"onUpdate:fileList":a[4]||(a[4]=e=>uploadImage.value=e),onOnBeforeRemove:onImageRemove},null,8,["action","file-list"])]),_:1})])]),_:1},8,["visible"]),createVNode(p,{class:"mt-4"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(videoList.value.reverse(),e=>(openBlock(),createBlock(m,{key:e.VideoName},{actions:withCtx(()=>[createVNode(u,{content:"您确定要删除此视频吗？",type:"error",onOk:v=>deleteVideo(e)},{default:withCtx(()=>[createVNode(unref(IconDelete))]),_:2},1032,["onOk"])]),default:withCtx(()=>[createVNode(c,{title:e.Title,description:e.Description},{avatar:withCtx(()=>[createVNode(r,{shape:"square"},{default:withCtx(()=>[createBaseVNode("img",{alt:"avatar",src:baseURL+baseImageFolder+e.HeadImage},null,8,_hoisted_5)]),_:2},1024)]),default:withCtx(()=>[createVNode(n,{slot:"avatar",src:baseURL+baseImageFolder+e.HeadImage,fit:"fill","preview-visible":!1,style:{cursor:"pointer"}},null,8,["src"])]),_:2},1032,["title","description"])]),_:2},1024))),128))]),_:1})])}}};export{_sfc_main as default};
