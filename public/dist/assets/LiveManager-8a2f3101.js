/* empty css              */import{a as c}from"./axios-3a3ab110.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{r as s,o as _,c as I,a,w as t,b as p,B as R,H as P,A as T,d as w,F as $,z as q,J as z,U as E,S as G,x as J,u as L,K,I as j,N as Q,D as W,P as X,G as Y}from"./index-9da721c7.js";const Z={class:"ml-4 mt-4 mr-4"},ee=p("h1",{class:"text-xl"},"直播管理",-1),ae=p("p",null,"封面图上传",-1),te=["src"],ve={__name:"LiveManager",setup(oe){const v=s([]),l=window.location.href.split(":")[0]+":"+window.location.href.split(":")[1]+":8020",V=window.location.href.split(":")[1].split("/")[2],f="/resource/upload/images/",u=s(!1);s(!1);const r=s(""),n=s(""),g=s([]),d=s([]);m();function m(){c.get(l+"/api/liveList").then(i=>{v.value=i.data})}function h(i){c.get(l+"/api/deleteLive?id="+i.Id+"&headImage="+i.HeadImage).then(o=>{m()})}function b(i){n.value=i.name}function x(){n.value!==""&&c.get(l+"/api/deleteImageFile?imageName="+n.value),n.value="",r.value="",g.value=[],d.value=[]}async function k(){return n.value===""?(alert("封面图不能为空。"),!1):r.value===""?(alert("直播标题不能为空。"),!1):(await c.get(l+"/api/addLive?title="+r.value+"&headImage="+n.value+"&record=false"),m(),n.value="",r.value="",g.value=[],d.value=[],!0)}function B(){c.get(l+"/api/deleteImageFile?imageName="+n.value)}return(i,o)=>{const y=R,N=z,U=E,F=G,H=P,S=j,A=Q,C=W,D=X,M=Y,O=T;return _(),I("div",Z,[ee,a(y,{type:"primary",onClick:o[0]||(o[0]=e=>u.value=!u.value)},{default:t(()=>[w("创建直播")]),_:1}),a(H,{visible:u.value,"onUpdate:visible":o[3]||(o[3]=e=>u.value=e),onCancel:x,"on-before-ok":k,width:"auto"},{title:t(()=>[w(" 创建直播 ")]),default:t(()=>[p("div",null,[a(F,{direction:"vertical",class:"w-full"},{default:t(()=>[a(N,{placeholder:"直播标题",modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=e=>r.value=e)},null,8,["modelValue"]),ae,a(U,{"list-type":"picture-card",action:l+"/api/uploadImage","image-preview":"",limit:1,accept:"image/*",onSuccess:b,"file-list":d.value,"onUpdate:fileList":o[2]||(o[2]=e=>d.value=e),onOnBeforeRemove:B},null,8,["action","file-list"])]),_:1})])]),_:1},8,["visible"]),a(O,{class:"mt-4"},{default:t(()=>[(_(!0),I($,null,q(v.value,e=>(_(),J(M,null,{actions:t(()=>[a(D,{content:"您确定要删除此直播吗？",type:"error",onOk:le=>h(e)},{default:t(()=>[a(L(K))]),_:2},1032,["onOk"])]),default:t(()=>[a(C,{title:e.Title+e.Id,description:"推流地址：rtmp://"+L(V)+":1936/live/  推流码："+e.Id},{avatar:t(()=>[a(A,{shape:"square"},{default:t(()=>[p("img",{alt:"avatar",src:l+f+e.HeadImage},null,8,te)]),_:2},1024)]),default:t(()=>[a(S,{slot:"avatar",src:l+f+e.HeadImage,fit:"contain","preview-visible":!1,style:{cursor:"pointer"}},null,8,["src"])]),_:2},1032,["title","description"])]),_:2},1024))),256))]),_:1})])}}};export{ve as default};
